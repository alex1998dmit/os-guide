# os-guide
Пример развертывания приложения на heroku

## Основная терминология

* ``` Npm ``` - пакетный менеджер JS
* ``` Node ``` - платформа для JS, позволяющая ей работать вне браузера, нужна для бекенда в этом проекте
* ``` Heroku``` - облачная PaaS платформа для деплоя веб-проектов
* ``` Vue ``` - JS-фреймворк, пример клиентского приложения для деплоя
* ``` Express ``` - бекенд прослойка, служит в качетсве веб сервера для отдачи кода клиентского приложения

## Введение

Есть несколько способов для бесплатного профессионального деплоя приложений, самыми популряными платформами для этого можно считать heroku и github pages.
На мой взгляд heroku лучше, платформа предоставляет свой собственный клиент для удаленной работы с проектом, позволяют напрямую работать с бд,
переменными окружения и т. д. 
Для примера будем рассматриваться деплой vue-приложения, react и angular приложения деплоятся похожим образом. Помимо прочего, если не хочется 
производить все вычисления на js, можно развернуть дополнительный бекенд сервер и работать с ним через api.

## Замечание

* Предпологается, что читатель создал репозиторий с проектом на гитхабе и там располагается его приложение на JS.
* Пример приложения для деплоя - vue spa-приложение
* Команды начинающиеся с $ прописываются в терминале проекта

## Руководство

* Регистрируемся на хероку, заводим репозиторий с проектом (рекомендую github)
* Создаем новый проект на хероку (можно с сайта, можно с клиента heroku). Рекомендуется давать осмысленные имена, так как они в дальнешем могут послужить урлом для вашего приложения
* Устанавливаем Express внутри Vue приложения 
```$ npm install express --save ```
* В приложении, в корневой директориии создаем файл server.js и прописываем следюущие конфиги
```
// Подключаем экспресс
let express = require('express');
// Библеотека для работы с урлами
let path = require('path');
// Сервер статики
let serveStatic = require('serve-static');
// Наше приложение
app = express();
// Говорим сервреу что отдавать клиенту, в данном случае все собранные файлы с директории dist
app.use(serveStatic(__dirname + "/dist"));
// Инициализируем порт, если он не указан в переменных окруженения берем 5000
const port = process.env.PORT || 5000;
// Запускаем веб серевер на порту
app.listen(port);
console.log('server started '+ port);
```
* Важно, так как мы работаем с вебпаком для деплоя необходимо собирать проект перед заливом на сервер, иначе изменения не вступят в силу.
* Сборка проекта
```$ npm run build```
* Чтобы heroku запускал наше приложение нужно указать ему это. Для этого в файле ```package.json``` добавляем след строку:
// package.json
{
  "name": "<YOUR-PROJECT-NAME-HERE>",
  "version": "1.0.0",
  "description": "A Vue.js project",
  "author": "",
  "private": true,
  "scripts": {
    "dev": "node build/dev-server.js",
    "build": "node build/build.js",
    "start": "node server.js",   <--- Вот эта
...
* Теперь при запуске приложения нода на хероку будет запускать файл ``` server.js```
* Необходимо связать хероку-приложение и наш репозиторий, прописываем следующее:
```heroku git:remote --app <YOUR-PROJECT-NAME-HERE>```
* Это нужно для автоматизации наката изменений на хероку, теперь вся работу сводится к комитом, пушу на репозиторий и пушу на хероку
* Рекомендуется занести папку dist в ```.gitignore```
* Рекомендуется, в приложении задаем переменные окружения (можно на сайте, можно на клиенте [пример ниже на клиенте])
``` heroku config:set NODE_ENV=production --app <YOUR-PROJECT-NAME-HERE> ```
* Добавляем коммиты
* Пушим на хероку и в гитхаб
```git push heroku master```
* Наслаждаемся результатом, ссылка на ваше приложение есть на странице с вашим приложением на хероку или <YOUR-PROJECT-NAME>.herokuapp.com

## Ссылки 
[Мой репозиторий залитый на хероку]( https://github.com/alex1998dmit/scheldure-os-emulator)
[Статья с похожей тематикой: ](https://github.com/alex1998dmit/scheldure-os-emulator)
[Видео](https://www.youtube.com/watch?v=UftutR5hz3U)

